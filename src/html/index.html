<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>WanaKana Demo</title>
		<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		
    	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />

		<style type="text/css">
			.wk-site-header {
				background-color: #f3f3f3;
				border-bottom: 1px solid #e5e5e5;
				width: auto;
				height: 40px;
				padding: 0;
			}

			.wk-site-name {
				margin-left: 30px;
				margin-top: 5px;
				text-decoration: none;
			}

			.wk-content {
				padding: 15px 15px 10px 15px;
			}

			.wk-textarea {
				width: 90%;
				min-height: 240px;
			}

			.wk-result {
				width: 90%;
				margin-top: 15px;
				min-height: 240px;
			}
		</style>

	</head>
	
	<body>

		<div>

			<div class="row wk-site-header">
				<div class="navbar navbar-static-top">
					<div class="navbar-inner">
						<a class="brand" href="#">
							<div class="logo"></div>
						</a>
						<div class="wk-site-name">WanaKana</div>
				  	</div>
				</div>
            </div>

			 <div class="row-fluid">
                <div class="span10 wk-content">
            		
           			<textarea id="input" class="form-control wk-textarea" rows="3" autofocus="true"></textarea>
					<div id="result" class="well wk-result"></div>
	
                </form>
            </div>

		<script type="text/javascript" src="../wanakana.min.js"></script>		
		<script type="text/javascript">

			(function(wk) {

				var debounce = function(fn, delay) {

					var timeoutId,
						context = this;

					return function() {
						
						var args = Array.prototype.slice.call(arguments);

						function deferred() {
							timeoutId = null;
							fn.apply(context, args);
						}

						clearTimeout(timeoutId);
						timeoutId = setTimeout(deferred, delay);
					}

				}

				var textInput = document.getElementById('input');
				var textResult = document.getElementById('result');

				//
				// This could do with some optimisation
				// - We don't need to be calling toKana on the entire textarea value.
				// 	 Maybe using a modified 'http://ejohn.org/files/jsdiff.js'
				// 

				var inputChanged = debounce(function(e) {
					var buffer = textInput.value;
					textResult.innerHTML = (wk.toKana(buffer));
				}, 150);
				
				textInput.addEventListener('input', inputChanged);

			})(window.wanakana);

		</script>

	</body>

</html>